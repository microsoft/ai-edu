<!--Copyright © Microsoft Corporation. All rights reserved.
  适用于[License](https://github.com/Microsoft/ai-edu/blob/master/LICENSE.md)版权许可-->


## 基本概率知识回顾

### 先验概率（Prior Probability）

根据以往的经验进行统计和分析得到的概率。

问题1：一个袋子中装有6个白球，4个黑球，取一只球出来，拿到白球的概率是多少？

对于这个问题，一开始人们并不知道如何解答，于是有个英国人开始做试验：拿出一个来，记录颜色，放回并搅乱；再拿出一个来，记录颜色，放回并搅乱......如此重复500次，发现有300次拿到了白球，200次拿到了黑球。后来这个英国人写了一篇论文叫做《White and Black Ball》，宣布拿到白球的概率是0.6，与袋子中黑白球比例有关。

有个法国人看到了这篇论文，觉得很有趣，于是重复了这个试验，证实了取到白球的概率确实与球的比例有关，只不过为了写论文，他在体育场中放了70个排球和30个足球，让一个盲人去踢球，最终得到的结果是0.7，于是他的论文名称叫做《Volleyball vs. Football》。

当然后来意大利人也做了改良试验，不过这类论文再也没有被接收......但是大家都知道了结论，不用再亲自去做试验来验证了，所以叫做**先验概率**。

### 独立事件

问题2：一个袋子中装有6个白球，4个黑球，取第一只球出来是白球的概率是0.6，黑球的概率是0.4（先验概率，记作A），放回。取第二球出来是黑球的概率（记作B）是多少？

由于两个事件独立，不论$P(A)$如何取值，总会有$P(B)=0.4$，还是先验概率。

### 条件概率

问题3：一个袋子中装有6个白球，4个黑球，取第一只球出来是白色的（记作A），不放回，取第二球出来是黑球的概率（记作B）是多少？

先用排列组合的方法计算一下$P(AB)$的值：
- 10个球取两个，一共有$C^2_{10}$种方法；
- 取到任意一个白球的方法是$C_6^1$种；
- 取到任意一个黑球的方法是$C_4^1$种；
- 先白后黑$P(AB)$和先黑后白$P(BA)$是一样的效果，所以有2种方法。

综合以上：
$$
P(AB) = \frac{C_6^1 \times C_4^1}{2 \times C_{10}^2}=\frac{6 \times 4}{2 \times 45}=\frac{4}{15} \tag{1}
$$

其实$P(AB)$也是一种先验概率。

下面我们用条件概率公式来计算一下。条件概率公式：

$$
P(B|A) = \frac{P(AB)}{P(A)}=\frac{4/15}{0.6}=\frac{4}{9} \tag{2}
$$

如果利用先验概率方法也可以得到：因为不放回，所以还剩9个球（5个白，4个黑），第二球是黑色的概率为$P(B|A)=\frac{4}{9}$，与公式2的结果一致。

### 全概率定理

问题4：一个袋子中装有6个白球，4个黑球，取第一只球出来不管何种颜色都不放回（记作A），取第二球出来是黑球的概率（记作B）是多少？

- 当第一只球是白色时，$P(A_{white})=0.6$，第二只球是黑色的概率：$P(B|A_{white})=\frac{4}{9}$；

- 当第一只球是黑色时，$P(A_{black})=0.4$，第二只球是黑色的概率：$P(B|A_{black})=\frac{3}{9}$

根据全概率定理：

$$
\begin{aligned}
P(B) &= \sum_{i=1}^2 P(A_i) \cdot P(B|A_i) \\ \tag{3}
&=0.6 \times \frac{4}{9} + 0.4 \times \frac{3}{9}=0.4
\end{aligned}
$$

可以看到，不管第一个球是什么，第二个球是黑色的概率和先验概率一致。

### 后验概率（Posterior Probability）

问题5：还是那个口袋和那些球，已知第二次摸到了黑球（记作B），问第一次摸到白球（记作A）的概率是多少？

这里需要贝叶斯定理来求解，公式为：

$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)} \tag{4}
$$

结合全概率定理的另外一种写法：

$$
P(A_m|B) = \frac{P(A_m) \cdot P(B|A_m)}{\sum_i P(A_i) \cdot P(B|A_i)} \tag{5}
$$

公式5的分母就是公式4，而 $A_m$ 表示是拿到了白球或黑球，$m=1,2$，其中1代表white，2代表black。根据公式5，有：

$$
\begin{aligned}
P(A_1|B) &= \frac{P(A_1)P(B|A_1)}{P(B)} \\
&=\frac{0.6 \times 4/9}{2/5}=\frac{2}{3}
\end{aligned}
$$

### 概率密度分布

问题6：一个袋子中装有6个白球，4个黑球，有回放地每次取一只球，共取10次，问取到7次白球（另外3次当然是黑球）的概率是多少？

由于这是个二项分布模型（只有黑白两色），根据伯努利模型的概率密度函数公式：

$$
f(x;\theta)=\begin{cases} \theta & x=1(白色) \\ 1-\theta & x=0(黑色)  \end{cases} \tag{6}
$$

取到 $k$ 次白球的概率为：

$$
P(x_1,x_2,...,x_n|\theta) = C_n^k \theta^k (1-\theta)^{n-k} \tag{7}
$$

其中 $n$ 是试验的次数，$\theta=0.6$ 是白球的比例，$k$ 是白色球的次数，$k=x_1 + x_2 + ... + x_n = \sum_{i=1}^n x_i$，因为$x_i$的取值范围只有0和1，所以上例中7次白球3次黑球的结果是$x_i$是1的情况有7次，所以 k=7。

$$
P(k=7|\theta=0.6,n=10) = C_{10}^7 \cdot 0.6^7 \cdot 0.4^{10-3}=0.21499
$$

我们还可以令$k=[0,10]$，从而计算出所有分布的可能性来：

```
0.000105
0.001573
0.010617
0.042467
0.111477
0.200658
0.250823
0.214991
0.120932
0.040311
0.006047
sum=1.0
```

<img src="Images/BernoulliDist.png"/>

图1 参数为0.6时取到x次白球的概率

从图中可以看到，因为参数为0.6，所以取到6次白球的概率最大，为0.250823。而曲线下的面积相加为1，所以这确实是一个概率密度函数。

为什么图1的曲线不平滑呢？是因为试验样本数量太少，只有10次，如果增加到100次（相应地会取到70次白球），那么图1中的曲线会平滑很多。

### 问题与思考

- 我们在上面的例子中用公式4求解的问题5，请自己用公式5求解问题5。
- 图1中，如果 $n=20$ 的话，$x$ 值为多少时概率最大呢？概率是多少？