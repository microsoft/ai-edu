## 3.3 系统化思维能力

### 3.3.1 思维与系统化思维

#### 三个名词

先理清三个名词：思考（Think），思维（Thinking），思想（Thought）。

<img src="img/Slide9.JPG"/>

图 3.3.1 三个名词的关系

思考，是一个动词，是人的大脑的一种能力和行为，就是程序员们常说的“等会儿！让我想想！脑子有点儿乱，这是我写的代码吗？看上去很乱......嗯，这个聚类算法并不适合于做有标签的数据分类学习，对吧？”

思维，是一个名词，是思考的方法和角度，也可以说是一种习惯。思维的生理基础是大脑，但是相同的生理基础可以产生不同的思维方式，这是人脑最神奇的地方。思维有很多种分类，下面具体解释。

思想，是一个名词，是思考的结果，它会形成两个层次的意识：认知、判断。“认知”是被动的，帮助人们认识世界；“判断”是主动的，帮助人们改造世界。成体系的认知叫做“知识”，伟大的认知一般才会称为“思想”，比如“毛主席是军事家、思想家、革命家”；渺小的判断叫做“主意”，大一些的叫做“决策”，商业化后叫做“解决方案”。

#### 思维方式

以下是一些互相对立的思维方式或习惯。

- 逻辑思维与逆向思维
  
  - 逻辑思维注重因果关系，无论对错。“因为你写了这段代码，所以才会产生bug”，这是一种不正确的推论。“因为你忘记给变量初始化为 0，所以才会产生bug”，这种说法听上去就合理多了。

  - 逆向思维把原因和结果倒置或者是颠倒主次关系，比如司马光砸瓮（不是缸），在其他小朋友都在想办法“让人脱离水”的时候，司马光选择了“让水脱离人”，事后如何赔偿水缸就不用担心了，因为上官尚光家会赔钱。

- 线性思维与发散思维

  - 程序员大部门是线性思维的，逢山开路，遇水搭桥，因为要解决问题，所以总会找最简单最直接的解决方法。

  - 发散思维是人脑天生的思维方式，测试人员大部分是这种思维方式，因为要制造问题，想办法用各种测试用例让代码暴露问题。

- 结构化思维与碎片化思维

  - 结构化思维，面对复杂问题时，通过刨析其内部结构，找到引发问题的关键部分，制定有相对性的解决方案。庖丁解牛就是典型的结构化思维，他看到的不是牛，而是肌肉、筋络、骨骼结构。结构化思维有助于建设知识体系。
  
    比如遇到一个程序的性能问题，一个有经验的程序员应该从代码逻辑、硬件环境、运行环境、数据存取、网络吞吐、磁盘读写等多个方面进行分析思考。

  - 碎片化思维是指人们在长期接受各类不完整、缺乏逻辑性、支离破碎信息的过程中逐渐形成的一种表面化、片面化、简单化和情绪化的思维模式。现在人们从手机接受各种碎片化信息，这些信息的发布者大多具有商业目的，或欺骗利诱，或哗众取宠，不利于知识体系的建立。

    程序员们最喜爱的一个网站，恐怕就是 stackoverflow 了，因为里面有很多前人的经验总结，主要是针对某个具体问题的。如果需要解决一些比较直接的问题，比如一个 API 调用失败，或者一个 Python 包安装不上，通常用这种碎片化的信息就可以解决。
    
    如果想解决一些复杂问题，比如“深度神经网络如何调参”，那么 stackoverflow 通常不会给予直接的答案，即使有的话，也可能不是你想要的答案。

- 平行思维与对抗思维
  
  - 平行思维要求聆听、理解他人的观点，赞扬与自己相同的观点，然后提出与自己不同的观点与对方讨论合作的可能性。
  
    比如，木头说：“这个系统现在运行得太慢了，我认为需要用 C++ 重写关键组件以提高性能"。石头说：”我非常同意要提高性能，咱们英雄所见略同（平行思维的典型特征），由于用 C++ 重写需要一个月时间并且有风险，咱们是不是可以先用更多的机器来分担负载，测试一周后再决定是不是要重写？” 木头欣然同意。

  - 辩论大赛的双方通常采用对抗思维，只要是对方说的论点就是不对的，想办法用一些反例来证明对方的错误，进而证明自己是对的。又可以叫做垂直思维。

    在平行思维的例子中，如果石头用对抗思维说：“用 C++ 重写需要一个月时间并且有巨大风险，所以根本不可行。用更多的机器来分担负载是一种最佳的解决方案。” 木头听到后肯定还要和对方争论，最后不欢而散。

    当年的“3Q大战”就是对抗思维，最后的结果是两败俱伤。

- 零和思维与双赢思维

  - 零和思维(Win-Loss）是博弈论中的一个概念，博弈的双方，一方得益，另一方必然吃亏，此消彼长，二者相加总是为零。赌场中的庄家与赌客之间就是零和思维。在一个软件生态环境中的各路竞争对手也是零和思维。

  - 双赢思维（Win-Win）是双方合作的基础，在保持各自底线的前提下把竞争变成合作，获得各自的利益。微软放弃自己的 IE 浏览器，转而采用 Chromium 内核做 Edge 浏览器，是一种单方面的双赢思维，Google 对此当然是欢迎的，而微软得到的好处是站在巨人的肩膀上让自己看得更远。


#### 从解决简单问题到系统化思维

先回忆一下 2.5 节中提到的“解决问题的能力”的主要内容。

通常来说，一个问题会包含有多个因素，这些因素都是**并列关系**，在拓扑结构上，如图 3.3.2 的**星形结构**。在某个特定条件下，只有一个因素会引发这个问题的出现。发现这个引发因素并加以解决，就是“解决问题的能力”体现。

而本节中的“系统化思维能力”所面对的问题，不仅仅是简单的一对一的因果关系，更多的是如图 3.3.2 中另外四种形式所示的复杂关系。所以，解决（简单）问题的能力也可以看作是一种简单的系统化思维能力。

<img src="img/Slide10.JPG"/>

图 3.3.2 系统化思维的几种形式

**这些思维形式的形成，是因为系统（问题）本身就是这种结构**，而并非无中生有。“读万卷书行万里路”是形成系统化思维的必经之路，简单说就是见多识广。

### 3.3.2 串行化系统与思维形式

解决单个问题，只需要线性思维就可以了，就是所谓“头疼医头脚疼医脚”。如果问题的依赖链条较长，就需要串行化的“系统思维能力”了，这是系统化思维中最简单的形式。

木头在做面试官时，首先会考察算法和编码能力，如果到后面还有时间的话，总会问下面这个问题：**北京城区需要有多少个加油站，可以达到加油排队时间不超过 10 分钟的服务质量？**

要解决这个问题需要一系列的假设数据支持，有些数据是可以从网上查到的，有些是常识，剩下的就需要靠推理了。

<img src="img/Slide11.JPG"/>

图 3.3.3 北京有多少个加油站


正确的解题思路如下：

#### 1. 北京有多少人口？

可以从官方的数据上得知，北京的常驻人口为 2100 万。

#### 2. 汽车保有量

从网上可以查到官方的统计数据，但是也可以这样推算：

1. 可以从官方的数据上得知，北京的常驻人口为 2100 万。
2. 假设是三个人组成一个家庭，那么一共有 700 万个家庭。假设每个家庭拥有一辆汽车，则一共有 700 万辆汽车。
3. 但是由于以下因素，会造成这一数字的不准确：
    - 摇号限制购买的措施，这个数字会减少
    - 很多年轻人还没有成家，但也可能有私家车，这个数字会增加
    - 北京还有很多企事业单位用车
    - 北京的出租车大概有 6 万辆
4. 上面几个因素有增有减，所以最后的汽车保有量大概就是 700 万辆左右。


#### 3. 出车率

不是每个有车的人都要开车，并且距离上班比较近的人不会开车上下班，还有限号措施（我们忽略电动汽车，因为它数量较少而且不需要加油）。据在木头居住的小区内观察，每天的出车率比疫情之前减少很多，大概只有 30%。这说明大家都有了节能环保绿色出行的理念，当然，也有可能是单位附近的停车费太高。

那么每天在马路上跑的车大概有 700 万辆 x 30% = 210 万辆

#### 4. 每天行驶多少公里？

北京的面积是 1.6 万平方公里，近似圆形，那么根据 $S=\pi r^2$ 公式，得到 $r=71$ 公里。由于此问题是估算北京城区的加油站数量，所以减去 2/3，可以认为半径为约 25 公里。也就是说人们上下班开车来回的平均距离为 25公里 x 2 = 50 公里左右。

#### 5. 一箱油可以跑几天？

- 大排量汽车越来越多，SUV 已经成为了购车首选，所以导致车辆每百公里耗油平均为 8 升。

- 一般的汽车的油箱容积为 50 升，按一周开5天（4天工作日 + 1天休息日开车出门办事或旅游）。

50 升 / 8升 x 100公里 = 625 公里，这是一个理想的里程。在城市里开，实际上是 500 公里左右就需要加油。

那么一箱油可以跑：500公里 / 50公里每天 = 10天

#### 6. 每天有多少车需要加油？

10天 / 5天每周 = 2周，即大概每个月加两次油，平均 15 天加一次油。
那么每天需要加油的车辆为 210万辆 / 15天 = 14 万辆。

#### 7. 加油站的服务质量

- 以 92 号汽油为例，加油站一般有至少 4 把油枪，可以同时加油，即可以同时服务 4 辆车。
- 每辆车的加油时长大概是 2 分钟。
- 我们要保证排队时间不超过 10 分钟，加上司机付费的时间，大概是每把油枪排 4 辆车。

那么每小时可以给 60分钟 / 10分钟 x 4把油枪 = 24 辆车加油，可以约等于 25 辆车。

全天 24 小时营业，但是司机一般会在早晚上下班的时段来加油，也就是峰值时段大约是 4 个小时。

每个加油站可以一天加油 25 辆车 x 4 小时峰值时段 = 100 辆车。

如果忽略了这个峰值时段，那么需要的加油站数量将会大大减少。就好比在双 11 购物节的时候，大量的用户涌入网站，需要 10000 台服务器才能处理，而在平时，只需要 1000 台服务器就可以搞定。

建设一个加油站要花很多钱，但是多加一把油枪不会花很多钱，所以可以用增加油枪数量的办法来缓冲峰值时段问题。

#### 8. 需要多少个加油站？

14 万辆 / 100 辆 = 1400 个加油站。

所以最后的答案就是 1400 个加油站。如果推算出 1000~1500 个，都是在合理范围内。

#### 小结

以上 8 个问题，每个问题都不是很难，难的是可以把它们串起来，最后解决一个系统性的问题，那么市政府对加油站建设的规划就可以按照这个推断来进行。数量少的话，车主加油会等较长的时间；数量多的话，加油站的利用率较低，经济上不划算。

这种思维形式的难点是：

- 不容易找到合理的上游依赖问题，很容易发散。
- 不能正确地解决每个依赖的问题，差之毫厘谬之千里。
- 堆栈较深（依赖链条长）时，没有信心/耐心继续下去。

既然有串行化的思维形式，那么有没有并行化的思维形式呢？有！但是其具体表现形式是下面要介绍的金字塔状思维形式和网状思维形式。

### 3.3.3 金字塔状系统与思维形式

<img src="img/Slide12.JPG"/>

图 3.3.4 如何举办一场音乐会

#### 0. 总体目标

木头有一个大乐队，50 多人，都是微软员工，来自各个部门，木头是这支乐队的队长。平时排练，但是没有什么合适的演出机会，于是，木头想自己举办一个音乐会。

怎么开始筹备呢？

#### 1. 要素分解

俗话说：没吃过猪肉还没见过猪跑吗？木头虽然没有举办音乐会的经验，但是看了那么多音乐会，也大概其知道组成一场音乐会的要素有三：

- 表演部分
- 观众部分
- 场地部分

#### 2. 解决方案

- 表演部分

  需要有演员（歌手乐手）和曲目（歌曲乐曲）。
  人的因素是首位的，歌手乐手都有了，而且可以复用，即一个歌手可以唱多首歌，一个乐手可以在多首曲目中伴奏。
  曲目也有很多可以选择的，国内的流行歌曲环境非常的好，另外乐队内还有古典乐手和民乐手。

- 观众部分

  需要让观众知道具体的时间和曲目，届时能够前来观赏。在公司内部有各种宣传手段，比如电子邮件、实时通信，最合适的形式就是“演出海报”。
  由于是内部演出，就免去了票务部分。

- 场地部分

  公司内部有两个大的会议室，可以容纳百人以上，作为演出场地非常合适。

  但是平时排练也要有场地，好在公司相关领导很支持木头的计划，排练场地就放在大会议室里，一般都是晚上排练，不会影响白天开会。

#### 3. 执行计划

- 先把演员们分成多个小组，或者自由组合，每个小组负责一个曲目。
- 曲目选择好以后，要进行编曲，然后大家开始排练。
- 排练用的乐器有“吉他、贝斯、键盘、鼓”四大件儿，其它的一些特殊乐器，比如小提琴、口琴、笛子等等由乐手自己准备。
- 由于排练场地只有一个，不同的组排练都有不同的时间，事先安排好。
- 海报部分，乐队内恰巧有 designer（设计师），当仁不让地负责设计海报。
- 海报设计完成后，一是形成 16:9 的电子版在楼内的各个演示屏上滚动播出，二是可以拿出去印刷，便于张贴。当然还需要中英文两个版本。
- 舞台搭建在演出日期前一天完成，各个小组按演出顺序进行彩排。
- 音响在一场音乐会里至关重要，木头特地找领导购买了调音台、线材、功放、音箱等设备。

#### 小结

- 一个复杂的问题（目标）由多个要素组成，也就是子目标。
- 而完成这些子目标需要完成一个或几个任务。
- 每个小任务都需要在时间或空间上进行周密的部署与持续的努力才能达成。
- 从时间上看，以海报任务为例，设计、印刷、张贴、回收，是前后阶段顺序，每个阶段都需要有人、有场地、有方法、有工具才能完成。排练场地本身是一个空间，但是也需要时间的计划才能安排好很多组的排练。
- 从空间上看，以场地为例，舞台搭建的位置、音响布置的覆盖面、调音台中控的地点、有长度限制的线材的连接方式、观众的座椅位置、录音录像师的机位、乐器在舞台上的摆放位置、麦克风的排列形式，等等等等，都是需要联动考虑的问题。

### 3.3.4 环状系统与思维形式

<img src="img/Slide13.JPG"/>

图 3.3.5 环状系统的负反馈

先看一种比较简单常见的环状反馈系统。其原始系统如图 3.3.5 左上所示，只有“输入、信号处理、输出”三个环节。

但是经常有这种需求：当输出端电平太高时，需要输入端智能地调低电平，所以就在输出端增加一个采样点，把输出信号反馈给输入端，并在结合点上与输入信号电平相减（因为是负反馈），这样在输出端最终得到的就是一个相对平稳的信号。

在思考时，通常人们会认为自己的思想无比正确，主意无比美妙。但是当你说出你的主意并得到一些 feedback（反馈）后，会纠正你的一些错误想法，把这些信息加入到输入端重新思考，才会得到大家都认可的好主意。

还有一种比较复杂的形式，一个输入通常是经过了很多个环节处理，最后反馈回来，对最初的输入做矫正。如图 3.3.5 的右图所示的一个例子：


1. 用户：“现在的系统运行有些慢，希望能够提升一下整体效率。”
2. 需求人员：“好的，我们马上和开发部门商量。”
   需求人员：“攻城狮们，咱们如何才能提升一下系统的整体效率，以便让用户高兴？”
3. 开发人员：“想整体提升的话，需要提升每一个组件的效率，要花很长时间。不如我们先提升一下关键组件的效率吧？但是这也会花几周的时间，会造成其它任务的延迟，用户不会高兴的。”
4. 开发人员：“另外，如果重写关键组件，会用空间换时间，运行快，但是占内存较大，希望最终产品的工程部署人员要注意。”
5. 产品人员：“果真如此的话，那么以前运行关键组件所在机器上的其它组件就必须部署到其它地方运行。我们需要用户另外购买几台设备来运行其它组件，这样用户不会高兴的。”
6. 产品人员：“需求大哥，你们再和用户确认一下吧？”

本来是一个好的出发点，但是经过一个环状的系统走下来，反而事与愿违。用户在得到一个好处（运行性能提高）的同时，可能会等待更长的时间获得新功能，或者花更多的钱来购买设备。

### 3.3.5 网状系统与思维形式

网状系统（或者说是表格形式）思维是最复杂的一种形式，因为它涉及到了横向思维和纵向思维两个方向，甚至是多维的。而其它的思维形式都是单向的。

<img src="img/Slide14.JPG"/>

图 3.3.6 环状系统的负反馈

在软件开发过程中，如图 3.3.6 所示，从纵向看，通常是多个小组分别完成各自的子系统，每个子系统又包含一系列的模块。从横向看，不同子系统的模块组成一个端到端的功能。项目管理者在纵向上需要协调各个小组的进度，这样才能在横向上把不同子系统的功能串联起来，尽早得到一个可运行的系统。

在机器学习中，通常有很多参数需要调节，比如深度神经网络中的步长值、样本批大小、卷积核的尺寸、正则化的参数等等，这些参数互相影响，网格状的参数搜索可以帮助我们找到最佳的参数组合。

<img src="img/Slide15.JPG"/>

图 3.3.7 质量指标之间的竞争

在软件质量控制过程中，如图 3.3.7 所示，需要软件可以达到很多种质量指标，如：正确性、可靠性、易用性、高效率、可维护性、可移植性等等。但是其中的某些指标是相克的，一个指标的提升会带来另外一个指标的下降。

在足球场上，教练会强调两点：一是全队三条线在横向上的步调一致，一起压上进攻，或者一起收缩防守；二是在纵向上，同一边的后卫、中场球员、前锋要协调进攻。在排球场上，六个队员形成 2x3 的网格阵型，兼顾进攻与防守。

以上这些都是网状思维的典型应用场景。
