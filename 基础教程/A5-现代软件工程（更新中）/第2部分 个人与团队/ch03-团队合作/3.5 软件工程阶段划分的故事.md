## 3.5 软件工程阶段划分的故事

现代软件工程的阶段划分方法已经非常成熟了，但是读者可能会产生的问题是：这些阶段真的都有必要存在吗？会不会很浪费时间？

在一些小的软件公司中，由于资源的限制，可能会免除其中一个或几个环节；但是在大的软件公司中，还需要在经典的划分方法上更加细化，才能适应复杂软件或复杂团队的需要。

从下面的故事中，读者可以从小到大逐步领会到经典划分方法的必要性。

<img src="Images/Slide14.JPG"/>


### 3.5.1 开发-修改

给自己写软件。Build for Self.

最开始，写软件的人都是为自己写的，为了完成某项繁琐的重复的任务，所以只有“开发-修改”两个步骤。

比如，木头想做一个计算器工具给自己用，因为这个应用场景已经烂熟于心了，所以很快就用 XAML + C# 写了一个粗糙的版本，只能做“加减乘除”，发现 bug 就改一改，自己能用就行。

### 3.5.2 需求-开发-修改

给朋友写软件。Build for Love.

坐在木头旁边工作的小 D 是个女生，觉得那个计算器工具很好，让木头给她拷贝一份。木头心想：“既然是给朋友用，就不要太简陋了吧。” 于是问小 D 都需要什么功能，小 D 想了想，说：“我经常需要用到平方开方计算，你把这两个功能加上吧。” 

这就是**需求**的原始形态，面对面简单说两句就能搞清楚了。如果有了 bug 的话，小 D 也是直接和木头说一下，当时花两分钟就改好了。

### 3.5.3 需求-开发-测试-共享

免费给更多的人写软件。Build for Friendship.

中午大家一起吃饭的时候闲聊，小 D 说起了木头的计算器工具，大家都很感兴趣，都想要一个能满足自己特殊需要的版本。木头也很高兴能帮到大家，就一个一个地询问了他们的需求，综合到一起；写好软件后，自己仔细**测试**了一下每个功能，不然每个人都来报 bug 就太丢脸了；然后木头把这个测试好的统一版本放到一个**共享**文件夹中，大家免费下载使用。

### 3.5.4 需求-设计-开发-测试-分发

写复杂的商业软件。Build for Business.

木头的计算器工具受到了很多人的欢迎。有一个公司觉得这款软件如果再丰富、美观一些，变成一个基于数据库的统计、计算软件，可以做成商业化软件卖钱。所以联系到了木头讨论这件事。

木头觉得自己完成不了这件事，就和公司老板说明了情况，老板也觉得机会很好，就成立了一个项目组，和木头一起完成这个项目。

首先是需求部分，和以前的简单需求不同，需要进行需求分析了，要出需求分析文档。

其次，项目结构复杂，涉及到数据库等技术，需要做系统设计；而且界面也复杂，需要一个 designer 来做界面设计。设计好后，写出系统设计文档，大家才能并行工作，这和木头一个人单枪匹马的情况完全不同，那时设计都在脑子里。

最后一步的**分发**，严格来说不属于软件工程的范畴，但是为了配合后来发展的商业化软件的加密或 Licence 需求，也变得越来越复杂，需要在开发阶段给与配合。形式上，也经历了磁带、磁盘、光盘、远程下载、互联网共享等媒介，变成了一件很复杂的工程。尤其是加密，最初都是用加密盒，接在计算机的串口上，软件定时读取串口中的密钥，检测合法性。

### 3.5.5 需求-原型-设计-开发-测试-部署

写商业化的网络服务软件。Build for Service.

上面那个商业软件发布了，公司挣了些小钱儿，老板觉得还可以再挖掘一下商业潜力，就找了几个专业人士一起商量，觉得如果把这款软件变成一个服务，放在互联网上供大家使用，并收取一定的服务费，这样可以扩大用户范围，还省去了分发的麻烦。

这也是第一次做网络服务软件，木头的团队为了确保能够正确理解需求，先做了一版**原型**，里面除了界面以外，后台的功能都是模拟的，并不进行真正的计算。老板和几个专业人士看完后，提了些意见，又出了一般原型，这才开始后续的开发。

做好软件后，先在本地测试，然后在电信的机房申请了几个机位，把软件**部署**上去，进行真实环境测试，然后开放给公众使用。

### 3.5.6 需求-原型-设计-开发-测试-部署-运维

写可控的商业化服务软件。Build for Smooth.

上面的服务发布后，赚了大钱，老板给木头升职加薪，木头也在公司附近租了一个条件好一些的大房子，免去一些通勤上的辛苦。

运行了一段时间后，也发现了一些小问题，但是由于是网络服务，debug 的困难很大。另外，每逢周五，就会发现有很多用户蜂拥而至登录使用，而其它时间用户量平稳。后来木头才知道那是因为大家都要在周五写总结，需要统计数据。

木头和大家商量，在每个关键的业务环节都增加了日志，在硬件资源的使用上也增加了监控，这样就形成了完整的运行维护体系，故障排查时定位很精确。定期检查日志，或通过实时监控**运维**数据，就可以针对资源不足给与报警，再进行人工处理。


### 3.5.7 积累-需求-原型-设计-开发-测试-部署-运维

写可持续的商业化服务软件。Build for Future.

在运营过程中，用户经常会发邮件提出一些问题和建议，每天收集整理这些邮件很麻烦。木头就在软件中开通了一个舆情频道，用户可以在里面吐槽。木头的团队还需要对这些舆情进行梳理，分成“问题”和“诉求”两类，是问题的赶快解决，是诉求的记录在团队内部的 DevOps 系统的 backlog 里。另外，团队自己也会经常有一些想法，改善现有的用户体验，或是增加新的功能，同样写在 backlog 里。

这样**积累**一段时间后，backlog 里就有了很多内容，木头和同事们把它们都看一遍，挑其中重要的条目变成新的需求，进行下一轮的开发。
