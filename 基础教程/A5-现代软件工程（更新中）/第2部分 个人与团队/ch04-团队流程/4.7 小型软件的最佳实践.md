
## 4.6 小型软件的最佳实践

我们以做一个计算器软件为例，说明开发一个小型软件的最佳实践（Best Practice）模型，如图 4.7.1 所示。

<img src="Images/Slide19.JPG"/>

图 4.6.1 

### 4.6.1 Make it Work - 能运行

首先，我们做一个比较粗糙的原型，只要能运行就行，结果可以是不正确的。

从功能上看：
1. 提供基本的输入功能，包括数字和运算符，但是只有“0~9,+,=”等 12 个按键，而且排列得七扭八歪；
2. 提供输出显示功能，能把输入显示在屏幕上，但是目前阶段只能显示“1,2,+,=”四种字符；
3. 输入“1+2”后，按“=”键，在屏幕上可以显示结果，但是结果可能是错误的“2”，而不是预期的“3”。

从界面上看：
1. 几个按钮的大小和位置不整齐，但不影响使用；
2. 显示框歪歪扭扭，但还能看清楚数字；
3. 外边框也不是很美观，用了很不协调的红色。

如图 4.6.2 左子图所示。

<img src="Images/Slide19.JPG"/>

图 4.6.2 

### 4.6.2 Make it Correct - 结果对

本步中的关键是要求结果正确。

1. 原型可以工作了，但是结果并不正确，所以需要 debug 来排查错误。
2. 顺手把几个按钮的大小和位置调整得好看一些，补全了四则运算的按键，再把边框改成搭配的黄色，显得稍微懂一些美学，别太给咱们程序员丢脸。
3. 再次输入“1+2=”后，可以得到正确的结果“3”了。
4. 能显示更多种类的字符了，但是显示区长度还比较短，只能有 6 个字符。

如图 4.6.2 右子图所示。

### 4.6.3 Make it Fast - 算得快

本步中的关键是要让结果迅速地出现。

结果虽然正确了，但是发现再输入“=”后，要等 3 秒钟以上才得到结果。这是怎么回事呢？

经过代码检查和 debug 发现：

1. 输入的数字，首先被变成了字符串，在接收到“=”号输入后，从屏幕显示缓冲区把字符串取出来，解析成两组数字“1,2”和“+”号，再进行实际的数学计算。这个设计糟糕透了。
2. 不知道哪一位程序员脑洞大开，把本来可以在本地进行的计算设计成调用网络服务，还号称是可扩展的 B/S 模式，将来可以调用任何新实现的数学运算。
3. 最气人的是，为了显示美观，有人引入了一个巨大的第三方库，而且对该库没有进行任何安全性检查，不知道它都跑了哪些逻辑。
4. 最难以发现的是，每次运算都会触发一次日志记录操作，由于开发过程中的自动测试用例也写日志，导致日志文件变得越来越大，打开、寻址、写入、关闭文件的操作变得很慢。

当然，以上这些都是在原型阶段发现的问题，还有可以纠正的机会。

### 4.6.4 Make it Rich - 功能全

本步中的关键是要实现所有设计的功能，并保证性能没有明显下降。

在经过需求评审和设计评审后，这个项目进入了正式的实现阶段。已知的功能有：
1. 支持按键数字从0-9；
2. 操作符支持“加减乘除”；
3. 显示区可以显示 10 个字符了，在超过 10 个字符时，用户输入时会有“滴滴”的报警声；
4. 由于还没有收到 Designer 的设计图，界面上还是有些歪歪扭扭的，而且字体的选择也有些问题，上下边界没有对齐。

如图 4.6.3 左子图所示。所以虽然功能都已经实现了，还是没法交给最终用户使用。

<img src="Images/Slide20.JPG"/>

图 4.6.3

### 4.6.5 Make it Live - 给用户

终于收到 Designer 的设计图了：

1. 0-9 十个数字的排列顺序让程序员们讨论了半天，为什么 “789” 在上面？找到了一个实际的计算器一看，确实是这样排列的；
2. “加减乘除”四个按钮的顺序也是颠倒过来的，并且与左侧数字去拉开了距离；
3. 字体统一使用等宽形式，上下边界也对齐了；
4. 按键区与显示区的中线对齐，上下左右的边界间距也都合理；
5. 增加了“删除”按钮，可以随时修改输入错误，而在此之前，程序员们测试时都是一通乱按，无所谓对错；
6. 界面边框不再是七扭八歪的了，很规矩。

如图 4.6.3 右子图所示。这样修改之后，再次经过回归测试，功能性能都没问题，这个简单的应用终于可以发布给用户使用了。


### 4.6.6 与研究员合作的软件系统

到此为止，一个小型软件就可以开发完毕了。


需求模糊

前景不确定

credit

性格

沟通技巧

