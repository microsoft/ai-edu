

https://towardsdatascience.com/10-common-software-architectural-patterns-in-a-nutshell-a0b47a1e9013

https://zhuanlan.zhihu.com/p/41395345

https://blog.csdn.net/Jayphone17/article/details/103651076

https://zhuanlan.zhihu.com/p/41395345

https://www.ou.nl/documents/40554/791670/IM0203_03.pdf/30dae517-691e-b3c7-22ed-a55ad27726d6

https://towardsdatascience.com/10-common-software-architectural-patterns-in-a-nutshell-a0b47a1e9013


## 常用的软件架构模式（atchitectural pattern）

稍微有些底层软件开发经验的读者，都知道有约 23 种软件设计模式，目的是保证代码的可重用性、可读性、可靠性。而且还有 7 种设计原则，是上述的 23 种 设计模式要遵守的基本规则。在上层的架构设计上，同样有设计原则和设计模式，一个合格的架构师就是根据这些原则和模式来工作的。

先用简单的一句话搞清楚几个概念：

**架构师**（architect）**构建**（construct）了一个**框架**（framework）后，用于约束那些使用者们只能使用规定的**结构**（structure）来进行二次开发。



架构模式是在给定上下文中对软件构建中常见问题的通用、可重用解决方案。架构模式类似于软件设计模式，但层次更高、范围更广。

1. 分层模式 (Layered pattern)
2. 客户端-服务器模式 (Client-server pattern)
3. 主-从模式 (Master-slave pattern)
4. 管道-过滤器模式 (Pipe-filter pattern)
5. 代理模式 (Broker pattern)
6. 对等模式 (Peer-to-peer pattern)
7. 事件总线模式 (Event-bus pattern)
8. 模型-视图-控制器 (MVC) 模式 (Model-view-controller pattern)
9. 黑板模式 (Blackboard pattern)
10. 解析器模式 (Interpreter pattern)

### 1. 客户端-服务器模式（Client-server）

这是一种最传统、最基本的模式，是其它一切模式的基础。见图 1 左子图。

#### 架构说明

最早的软件都是在主机（大型机或小型机）上开发的，使用者用哑终端方式通过串行接口接入到主机，实际上所有代码都是在主机上运行，因为哑终端只有输入、输出功能，没有计算能力。

后来出现了个人电脑 PC（Personal Computer），运算能力很强，并且有了局域网络。这两个技术突破让人们可以重新构建代码，把主要逻辑和数据放在主机（后称服务器）上，在终端（后称客户端）上运行界面代码，并通过快速的局域网络与服务器进行通信。主动发起请求的叫客户端，响应的一方叫服务器。当然，相比之下服务器的运算能力更强，是专用的商业计算机。

客户端-服务器模式由两个部分构成：一个服务器与多个客户端。服务器组件同时为多个客户端组件提供服务。客户端向服务器发启服务请求，服务器将相应服务信息回应给客户端。此外，服务器持续监听来自其它客户端的请求。二者之间一般采用 TCP/IP 网络协议。

#### 扩展模式

- 有些时候一台服务器不能满足客户端的所有请求，比如：在档案管理系统中，服务器 1 只负责处理查询身份证号码的请求，而服务器 2 只负责处理更改个人信息的请求。那么在客户端 1 中，不同的用户请求会发送到不同的服务器上，这是在客户端代码中预先配置好的。而在服务器端，服务器 1 的内存可能会比较大，因为它可以缓存成千上万个身份证号码，便于快速得到查询结果；而服务器 2 的硬盘（存储设备）读写可能会比较快，因为它要快速地更新数据。

- 还有一种可能就是两个客户端的权限不一样，客户端 1 权限较高，可以提供所有功能；而客户端 2 权限较低，只能提供部分功能。这在银行系统中常见：有的机器只能自助取钱，而另外一些机器可以存钱和取钱。

- 有些负载均衡网络设备，可以把客户端请求均匀地分配给服务台集群中的每一台服务器。也可以在服务器端软件中实现简单的负载均衡，即每次用户请求时先返回本服务器的繁忙状态：如果很忙，则告诉客户端访问其它服务器；如果不忙，则继续请求/响应；如果所有服务器都忙，则在客户端显示系统繁忙信息。

#### 优缺点

优点：

- 开发阶段可以在两端分两组同时进行。
- 客户端与服务器分离，排查错误方便。
- 一个服务器可以服务于多个客户端。
- 当多个服务器可以同时提供服务时，单个服务器的升级很方便。
- 所有数据都存储在服务器上，可以更好地控制访问和资源，以保证只有那些具有适当权限的用户可以访问和更改数据。
- 由于数据的集中存储，对数据的更新是更容易管理。

缺点：

- 当计算任务较重时，服务器可能成为瓶颈。
- 当数据传输较多时，网络带宽可能成为瓶颈。
- 需要客户端具有一定的计算能力。
- 当客户端较多时，升级客户端软件不方便。

#### 使用场景

电子邮件、文件共享及银行业务等在线应用。


<img src='img/Slide9.svg'>


### 2. 对等模式（Peer-to-peer）

这是客户端-服务器服务器模式的双向扩展。见图 1 的右子图。

#### 架构说明

对等模式中的组件称之为对等体（peer）或节点，既作为向其他节点请求服务的客户端，同时也做为响应其他节点请求的服务端。节点可以在运行过程中动态地改变其角色，即，既可以单独做为客户端或服务端运行，又可同时作为客户端与服务端运行。

在没有出现服务的年代，一个小公司内部往往使用对等网络来共享资源，它是一种投资少、见效快、高性价比的实用小型网络系统，比如 10 台计算机以下。

#### 优缺点

优点：

- 一个节点瘫痪时，其它节点还可以继续工作并提供服务。
- 可在网络的任何地方共享内容和资源。
- 由对等节点组成的网络易于扩展，而且比单台服务器更加可靠，不容易有网络瓶颈。
- 由对等方组成的网络可共享处理器，整合计算资源以执行分布式计算任务，而不只是单纯依赖一台计算机，如一台超级计算机。
- 用户可直接访问自己所在的节点计算机上的共享资源，在本地存储器上共享文件，而不必在远程服务器上进行共享。

缺点：

- 数据分布在每个节点上，管理困难。
- 升级软件时需要有计划地逐个节点升级，而且备份、恢复资源困难。
- 网络安全性差，资源分散，容易有薄弱环节
- 当用户所在的节点做为服务器时，会影响用户本地的计算性能。

#### 扩展模式


#### 使用场景

网络文件共享：Gnutella 与 G2)
流媒体协议：P2PTV 与 PDTP.
流媒体应用： Spotify.
区块链


### 3. 分层模式

分层模式用于对软件系统进行层次拆解，

每个层是一个子任务组，

每个层次为独立的抽象，为其上层抽象提供服务。

系统通常被拆分为以下四个层次：

- 表示层（也称为 UI 层）
- 应用层（也称为服务层）
- 业务逻辑层（也称为领域层）
- 数据访问层（也称为持久化层）

使用场景
通用桌面应用程序
电子商务 Web 应用
见图1 左子图



图 1

