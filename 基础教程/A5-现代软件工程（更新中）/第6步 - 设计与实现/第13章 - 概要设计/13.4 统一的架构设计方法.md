
## 13.4 统一的架构设计方法

总结一下上个小节中的内容，目前软件领域有几种主流的架构设计方法，见图 13.4.1。

<img src="img/Slide16.SVG"/>

图 13.4.1 主流的架构设计方法

下面我们对比这几种主流方法，发掘它们的共同点：

1. 在软件工程中，如果从需求出发的话，第一张图应该是给用户看的，不妨叫做**业务场景架构**。该图中没有逻辑，只有一些大的功能区，用来区分系统/子系统的边界。这张图在 13.2 节中已经绘制好了。

2. 第二张图是给开发团队的所有人（但主要是管理者）看的，应该是分层、分模块的软件功能静态模型，可以叫做**逻辑功能架构**。

3. 既然有了静态模型，还应该有动态模型来描述系统内部的交互行为，所以叫做**应用运行架构**。

4. 按照软件工程，有了静态和动态设计后，就可以进行软件开发了，所以我们需要有**软件开发架构**来指导、统一开发者的行为。

5. 产品部署虽然是最后的动作，但是需要在第 2,3,4 步就有统一考虑，而不是等软件开发完毕后再想。这一部分叫做**物理部署架构**。

6. 最后这一部分不是必须的，如果是面向企业的数据密集型的软件系统才会用到，叫做**数据存储架构**，而一般的计算密集型软件中，在第 2,3 步中可以顺带给出，因为静态架构中可以有数据库的存在，在动态架构中，也离不开数据的读写过程。

把上述步骤总结为表 13.4.1，形成**六视图法**。注意该表中各方法的顺序与图 13.4.1 有所不同，不会影响架构设计工作的进行。

表 13.4.1 架构设计方法的统一

||RUP 4+1|UML|C4|TOGAF|Other|$\rightarrow$|统一名称|
|-|-|-|-|-|-|-|-|
|1|场景视图|用户模型|上下文图|业务架构|逻辑架构|$\rightarrow$|业务场景架构|
|2|逻辑视图|结构模型|容器图|应用架构|逻辑架构|$\rightarrow$|逻辑功能架构|
|3|过程视图|行为模型|组件图|应用架构|运行架构|$\rightarrow$|应用运行架构|
|4|开发视图|实现模型|代码图|技术架构|开发架构|$\rightarrow$|软件开发架构|
|5|物理视图|环境模型|N/A|技术架构|物理架构|$\rightarrow$|物理部署架构|
|6|N/A|N/A|N/A|数据架构|数据架构|$\rightarrow$|数据存储架构|

【最佳实践：**两视图法**】

有些比较小的系统很难把上述架构图都画出来，可以只有“**业务架构 + 技术架构**”，其中，业务架构就是业务场景架构，技术架构的定义如下：

$$
技术架构 = 逻辑功能 + 应用运行 + 数据存储 + 软件开发 + 物理部署
$$

说白了就是把 2,3,4,5,6 混在一起画。在第十二章中讲技术架构演化的故事时，基本上就是采用了这种办法。

【最佳实践：**三视图法**】

如果对物理部署架构的要求较高，也可以把它从技术架构中拆出来，最后形成三张图：“**业务架构 + 软件架构 + 硬件架构**”。其中，业务架构就是业务场景架构，硬件架构就是物理部署架构，软件架构的定义如下：

$$
软件架构 = 逻辑功能 + 应用运行 + 数据存储 + 软件开发 
$$



架构设计关注点
https://blog.csdn.net/yb223731/article/details/119613815?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-119613815-blog-78109126.pc_relevant_aa2&spm=1001.2101.3001.4242.1&utm_relevant_index=3



每种设计在不同的阶段有不同的含义

|阶段|架构设计|概要设计|详细设计|
|-|-|-|-|
|业务场景|用户|业务场景架构图|用例图|
|逻辑功能|概要设计人员|逻辑功能架构图|类图、对象图|
|行为过程|概要设计人员|行为过程架构图|状态图、时序图、协作图、活动图|
|开发|开发人员|开发架构图|组件图、包图|
|部署|部署工程师|部署架构图|配置图|
|数据存储|开发人员|数据存储架构图|



最开始只有逻辑架构和物理架构


逻辑架构 = 模块划分 + 接口定义 + 领域模型

运行架构 = 技术选型 + 控制流划分 + 同步关系

开发架构 = 技术选型 + 文件划分 + 编译关系

物理架构 = 硬件分布 + 软件部署 + 方案优化

数据架构 = 技术选型 + 存储格式 + 数据分布



大型系统

架构设计
子系统设计

中型系统

系统设计



https://zhuanlan.zhihu.com/p/422882715


什么时机开始架构设计是十分重要的，业界也对这方面始终争论不休，有的主导预先设计，有的反对，有的人相对喜欢先做架构设计，有的人则懒得做，想到哪写到哪。
日常工作相对繁琐，面对的问题及系统现状也是千差万别，通常来说是在面对复杂问题和重要功能时需要进行架构设计，何为“复杂、重要”？
个人认为可以先从内容上做一些区分，比如下面是常见的需要架构设计的内容：
1、是否为全新的领域：如果是首次构建，架构的重要性是十分强的，而对于现有的系统增加个接口，架构考虑就会小很多了。
2、解空间小，或者压根没有一下子能想到的解决方案。
3、问题本身对于系统的要求特别高，相对难以实现，比如：可用性9个9，千万qps，未来变化频率十分高需要高扩展、灵活可配。
4、面临多方合作、协作时，需要一个从全局出发的指导。
5、需要精确衡量ROI的场景。
6、所开发的功能可能会引发相对较大的问题时。

然后再从时机的角度辅助判断：
1、在某项功能被重视起来，或者小步试错成功后准备大资源投入时。
2、系统的质量属性已经烂到了一定的地步，比如已经无法扩展、线上问题频发、研发质量下降、可用性已经无法良好提升等，忍无可忍时。
3、整体定位发生变化时


### 13.3.6 抽象

https://blog.csdn.net/hguisu/article/details/78258430

Capstera Business Architecture Framework



### 13.3.7 设计原则

1. 业务平台化
2. 核心业务分离
3. 隔离不同类型
4. 区分主流程、辅助流程


5. 不考虑具体实现
6. 关注用户能看到什么


