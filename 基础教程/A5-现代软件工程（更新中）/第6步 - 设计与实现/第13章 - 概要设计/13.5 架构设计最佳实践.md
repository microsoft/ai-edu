
## 13.5 架构设计最佳实践

### 13.5.1 设计难度简化

#### 1. 六视图法

现在读者再回过头来看表 13.4.1，就可以理解这些名词的含义了。我们把它们再次总结成表 13.5.1。

表 13.5.1 架构设计任务与关注点小结

|顺序|设计步骤名称|设计任务|关注点|
|-|-|-|-|
|1|**业务场景架构**|系统划分 + 功能覆盖 + 外部关系|业务齐全，子系统划分合理，用户可以看懂|
|2|**逻辑功能架构**|静态结构 + 功能模块 + 协作关系|功能全面覆盖业务需求，层级划分合理|
|3|**运行过程架构**|进程设定 + 状态转换 + 调用关系|运行过程合理，接口清晰，运行期质量可控|
|4|**数据存储架构**|内容格式 + 存储方式 + 读写控制|业务数据齐全，存储方式可靠，读写性能高|
|5|**软件开发架构**|代码结构 + 依赖关系 + 框架组件|代码文件结构清晰，依赖关系明确|
|6|**物理部署架构**|技术选型 + 节点规划 + 拓扑关系|系统、网络、节点的功能和性能|

按照软件工程的工作流程顺序，可以顺理成章地得到表 13.5.1 中的六个架构设计步骤，我们可以称之为**六视图法**。但是，一般的情况下，开发人员无缘遇到这么复杂的系统，所以我们可以按照下面的简化步骤来做设计。

$$
架构设计 = 业务场景 + 逻辑功能 + 运行过程 + 数据存储 + 软件开发 + 物理部署 \tag{13.5.1}
$$

#### 2. 两视图法

有些比较小的系统很难把上述架构图都画出来，可以只有两个元素组成：

$$
架构设计 = 业务场景架构 + 技术实现架构 \tag{13.5.2}
$$

其中，业务场景架构定义不变，技术实现架构的定义如下：

$$
技术实现架构 = 逻辑功能 + 运行过程 + 数据存储 + 软件开发 + 物理部署 \tag{13.5.3}
$$

说白了就是把表 13.5.1 中的 2,3,4,5,6 混在一起画。在第十二章中讲技术架构演化的故事时，基本上就是采用了这种办法。

在这种方法中，软件开发架构可以不强调，还可以把依赖的框架、组件、中间件画在图中，而无需单独说明代码结构。

#### 3. 三视图法

如果对物理部署架构的要求较高，也可以把它从技术实现架构中拆出来，最后形成三个元素：

$$
架构设计 = 业务场景架构 + 软件架构 + 硬件架构 \tag{13.5.4}
$$

其中，业务架构就是业务场景架构，硬件架构就是物理部署架构，软件架构的定义如下：

$$
\begin{aligned}
&软件架构 = 逻辑功能 + 运行过程 + 数据存储 + 软件开发 
\\
&硬件架构 = 物理部署架构
\end{aligned}
 \tag{13.5.5}
$$

同样，软件开发架构可以弱化。这种三视图法比较方便广大读者在任何规模的软件系统设计时使用。

在网络上的大多数架构图中，其实也是不知不觉中使用了这个实践方法，但是绘图的人或者传播的人自己还没有搞清楚，容易误导读者。一个有用的鉴别方法就是：当前后两张图风格不一致，或者项目不吻合时，基本上就是抄袭别人的，传播者按照自己的理解冠名，误人子弟。


### 13.5.2 


还想写什么？

1. 原则
2. 误区
3. 概要设计
4. 高并发、可扩展、。。。









抽取各个子系统中共用的部分

给做概要设计的人看

介于业务语言与技术语言之间，是对整个系统实现的总体上的架构，他需要指出系统的层次、系统开发的原则、系统各个层次的应用服务，例如，上述系统中可以分为、数据层（资源层）、数据服务层、中间构建服务层、业务逻辑层、表现层，并写明每个层次应用服务。

要说明产品分哪些应用系统，应用系统间是如何集成的，考虑两个事情：第一、考虑的是子系统间的关系。第二、考虑将可复用的组件或模块进行下沉，沉淀到平台层，为业务组件提供统一的支撑。



三要素

关联：系统是由一群有关联的个体组成的，没有关联的个体堆在一起不能成为一个系统。
规则：系统内的个体需要按照指定的规则运作，而不是单个个体各自为政，规则规定了系统内个体分工和协作的方式。
能力：系统能力与个体能力有本质的差别，系统能力不是个体能力之和，而是产生了新的能力





|系统设计|架构设计|概要设计|详细设计|
|-|-|-|-|
|系统规模|只应用于大型系统|主要应用于中型系统|主要应用于小型系统|
|设计负责人|架构师|技术专家|开发人员|
|设计对象|系统|子系统|模块|
|设计内容|把系统分解为子系统，<br>说明子系统之间的关系，<br>找出共同依赖的基础，<br>并考虑运行时的质量。|把子系统按照一定的原则<br>分解为模块，分配每个模<br>块具体功能，并确定模块<br>间调用关系和接口。|确定模块的算法、流程、<br>状态转换、数据结构等详<br>细信息，便于后续开发。|
|用途|确定轮廓，层次分解|分解模块，理清关系|确定细节，编写代码|
|输出文档|架构设计说明书|概要设计说明书|详细设计说明书|
|||||
|业务场景|业务场景架构图||用例图|
|逻辑功能|逻辑功能架构图||类图、对象图|
|运行过程|运行过程架构图||状态图、时序图、协作图、活动图|
|数据存储|数据存储架构图|数据表、库、文件的定义|
|软件开发|软件开发架构图|代码文件组织，框架选择|组件图、包图|
|物理部署|物理部署架构图||配置图|




系统设计



https://zhuanlan.zhihu.com/p/422882715




### 13.3.6 抽象

https://blog.csdn.net/hguisu/article/details/78258430

Capstera Business Architecture Framework



### 13.3.7 设计原则

1. 业务平台化
2. 核心业务分离
3. 隔离不同类型
4. 区分主流程、辅助流程


5. 不考虑具体实现
6. 关注用户能看到什么




绘图艺术

https://www.infoq.cn/article/crafting-architectural-diagrams/



设计原则
https://cloud.tencent.com/developer/article/1372372

可靠性
可扩展性
可用性


https://blog.csdn.net/hguisu/article/details/78259898


具体的设计实例：
- 高并发的设计
- 异地灾备的设计
- 消息队列的设计
- 微信系统的设计（点对点通信）
- 微博系统的设计（消息订阅，发布）
- 淘宝系统的设计
- 异地访问延迟
- 高性能
- 微服务
- 语音系统的设计
- 地图系统的设计


设计原则
https://blog.csdn.net/danpu0978/article/details/107274524


设计误区
https://blog.csdn.net/hguisu/article/details/78258430


