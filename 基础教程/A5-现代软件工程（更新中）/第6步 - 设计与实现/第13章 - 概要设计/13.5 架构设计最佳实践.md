
## 13.5 架构设计最佳实践



### 13.4.8 设计难度简化

【最佳实践之一：**六视图法**】

现在读者再回过头来看表 13.4.1，就可以理解这些名词的含义了。我们把它们再次总结成表 13.4.2。

表 13.4.2 架构设计方法名称与关注点

|顺序|设计步骤名称|关注点|
|-|-|-|
|1|**业务场景架构**|业务齐全，子系统划分合理，用户可以看懂|
|2|**逻辑功能架构**|功能全面覆盖业务需求，层级划分合理|
|3|**运行过程架构**|运行过程合理，接口清晰，运行期质量可控|
|4|**数据存储架构**|业务数据齐全，存储方式可靠，读写性能高|
|5|**软件开发架构**|代码文件结构清晰，依赖关系明确|
|6|**物理部署架构**|系统、网络、节点的功能和性能|

按照软件工程的工作流程顺序，可以顺理成章地得到表 13.4.2 中的六个架构设计步骤，我们可以称之为**六视图法**。但是，一般的情况下，开发人员无缘遇到这么复杂的系统，所以我们可以按照下面的简化步骤来做设计。

【最佳实践之二：**两视图法**】

有些比较小的系统很难把上述架构图都画出来，可以只有：

$$
架构设计 = 业务架构 + 技术架构
$$

其中，业务架构即业务场景架构，定义不变，技术架构的定义如下：

$$
技术架构 = 逻辑功能 + 运行过程 + 数据存储 + 软件开发 + 物理部署
$$

说白了就是把表 13.4.2 中的 2,3,4,5,6 混在一起画。在第十二章中讲技术架构演化的故事时，基本上就是采用了这种办法。

在这种方法中，软件开发架构可以不强调，还可以把依赖的框架、组件、中间件画在图中，而无需单独说明代码结构。

【最佳实践之三：**三视图法**】

如果对物理部署架构的要求较高，也可以把它从技术实现架构中拆出来，最后形成三张图：

$$
架构设计 = 业务架构 + 软件架构 + 硬件架构
$$

其中，业务架构就是业务场景架构，硬件架构就是物理部署架构，软件架构的定义如下：

$$
软件架构 = 逻辑功能 + 运行过程 + 数据存储 + 软件开发 
$$

同样，软件开发架构可以弱化。这种三视图法比较方便广大读者在任何规模的软件系统设计时使用。

在网络上的大多数架构图中，其实也是不知不觉中使用了这个实践方法，但是绘图的人或者传播的人自己还没有搞清楚，容易误导读者。一个有用的鉴别方法就是：当前后两张图风格不一致，或者项目不吻合时，基本上就是抄袭别人的，传播者按照自己的理解冠名，误人子弟。


抽取各个子系统中共用的部分

给做概要设计的人看

介于业务语言与技术语言之间，是对整个系统实现的总体上的架构，他需要指出系统的层次、系统开发的原则、系统各个层次的应用服务，例如，上述系统中可以分为、数据层（资源层）、数据服务层、中间构建服务层、业务逻辑层、表现层，并写明每个层次应用服务。

要说明产品分哪些应用系统，应用系统间是如何集成的，考虑两个事情：第一、考虑的是子系统间的关系。第二、考虑将可复用的组件或模块进行下沉，沉淀到平台层，为业务组件提供统一的支撑。



三要素

关联：系统是由一群有关联的个体组成的，没有关联的个体堆在一起不能成为一个系统。
规则：系统内的个体需要按照指定的规则运作，而不是单个个体各自为政，规则规定了系统内个体分工和协作的方式。
能力：系统能力与个体能力有本质的差别，系统能力不是个体能力之和，而是产生了新的能力










架构设计关注点
https://blog.csdn.net/yb223731/article/details/119613815?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-119613815-blog-78109126.pc_relevant_aa2&spm=1001.2101.3001.4242.1&utm_relevant_index=3



每种设计在不同的阶段有不同的含义

|阶段|架构设计|概要设计|详细设计|
|-|-|-|-|
|业务场景|用户|业务场景架构图|用例图|
|逻辑功能|概要设计人员|逻辑功能架构图|类图、对象图|
|行为过程|概要设计人员|行为过程架构图|状态图、时序图、协作图、活动图|
|开发|开发人员|开发架构图|组件图、包图|
|部署|部署工程师|部署架构图|配置图|
|数据存储|开发人员|数据存储架构图|



最开始只有逻辑架构和物理架构


逻辑架构 = 模块划分 + 接口定义 + 领域模型

运行架构 = 技术选型 + 控制流划分 + 同步关系

开发架构 = 技术选型 + 文件划分 + 编译关系

物理架构 = 硬件分布 + 软件部署 + 方案优化

数据架构 = 技术选型 + 存储格式 + 数据分布



大型系统

架构设计
子系统设计

中型系统

系统设计



https://zhuanlan.zhihu.com/p/422882715


什么时机开始架构设计是十分重要的，业界也对这方面始终争论不休，有的主导预先设计，有的反对，有的人相对喜欢先做架构设计，有的人则懒得做，想到哪写到哪。
日常工作相对繁琐，面对的问题及系统现状也是千差万别，通常来说是在面对复杂问题和重要功能时需要进行架构设计，何为“复杂、重要”？
个人认为可以先从内容上做一些区分，比如下面是常见的需要架构设计的内容：
1、是否为全新的领域：如果是首次构建，架构的重要性是十分强的，而对于现有的系统增加个接口，架构考虑就会小很多了。
2、解空间小，或者压根没有一下子能想到的解决方案。
3、问题本身对于系统的要求特别高，相对难以实现，比如：可用性9个9，千万qps，未来变化频率十分高需要高扩展、灵活可配。
4、面临多方合作、协作时，需要一个从全局出发的指导。
5、需要精确衡量ROI的场景。
6、所开发的功能可能会引发相对较大的问题时。

然后再从时机的角度辅助判断：
1、在某项功能被重视起来，或者小步试错成功后准备大资源投入时。
2、系统的质量属性已经烂到了一定的地步，比如已经无法扩展、线上问题频发、研发质量下降、可用性已经无法良好提升等，忍无可忍时。
3、整体定位发生变化时


### 13.3.6 抽象

https://blog.csdn.net/hguisu/article/details/78258430

Capstera Business Architecture Framework



### 13.3.7 设计原则

1. 业务平台化
2. 核心业务分离
3. 隔离不同类型
4. 区分主流程、辅助流程


5. 不考虑具体实现
6. 关注用户能看到什么




绘图艺术

https://www.infoq.cn/article/crafting-architectural-diagrams/



设计原则
https://cloud.tencent.com/developer/article/1372372

可靠性
可扩展性
可用性


https://blog.csdn.net/hguisu/article/details/78259898


具体的设计实例：
- 高并发的设计
- 异地灾备的设计
- 消息队列的设计
- 微信系统的设计（点对点通信）
- 微博系统的设计（消息订阅，发布）
- 淘宝系统的设计
- 异地访问延迟
- 高性能
- 微服务
- 语音系统的设计
- 地图系统的设计


设计原则
https://blog.csdn.net/danpu0978/article/details/107274524


设计误区
https://blog.csdn.net/hguisu/article/details/78258430


